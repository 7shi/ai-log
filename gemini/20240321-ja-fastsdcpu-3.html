<xap-inline-dialog-container role="dialog" class="xap-inline-dialog-container gmat-body-2 ng-tns-c1493224720-70 ng-star-inserted ng-trigger ng-trigger-dialogContainer" tabindex="-1" style="opacity: 1;"><div class="ng-tns-c1493224720-70"><div _ngcontent-ng-c3366247660="" msfileinsertable="disabled" class="ng-star-inserted"><div _ngcontent-ng-c3366247660="" class="overlay-header"><h4 _ngcontent-ng-c3366247660="" class="gmat-title-medium"> Preview </h4><button _ngcontent-ng-c3366247660="" mat-icon-button="" aria-label="Close settings" xapinlinedialogclose="" class="close-icon mdc-icon-button mat-mdc-icon-button mat-unthemed mat-mdc-button-base gmat-mdc-button" mat-ripple-loader-class-name="mat-mdc-button-ripple" mat-ripple-loader-centered=""><span class="mat-mdc-button-persistent-ripple mdc-icon-button__ripple"></span><span _ngcontent-ng-c3366247660="" aria-hidden="true" class="material-symbols-outlined">close</span><span class="mat-mdc-focus-indicator"></span><span class="mat-mdc-button-touch-target"></span><span class="mat-ripple mat-mdc-button-ripple"></span></button></div><!----><div _ngcontent-ng-c3366247660="" class="prompt-preview ng-star-inserted" style=""><multiturn-preview _ngcontent-ng-c3366247660="" _nghost-ng-c1264270593=""><div _ngcontent-ng-c1264270593="" msfileinsertable="disabled" class="preview-holder"><div _ngcontent-ng-c1264270593="" class="ng-star-inserted"><!----><!----><div _ngcontent-ng-c1264270593="" class="preview-section ng-star-inserted"><!----><table _ngcontent-ng-c1264270593="" class="preview-table"><tr _ngcontent-ng-c1264270593="" class="ng-star-inserted"><td _ngcontent-ng-c1264270593="" class="source-label">User:</td><td _ngcontent-ng-c1264270593="" class="prompt-text ng-star-inserted"><div class="document-embed drive-embed" data-drive-file-name="" data-drive-file-id="1yYhgjTadykp3p_brTY2CZSCFuEC-QOoD 11sFjIVcbz8RbgQl1RSfsIc5MxnC6VQUD 11YAFYIy3yJOGpnfJmZ5GDT02-78cN_ov 16QsXmDBiJyJQ_5Z92_YhYgUqXW-zkc9_ 1ZDz9QF1Xq-J1nDCHLMj-PaXMvK8S9bjl 1zxVPfIaJuOnTmZYYYcYU_ASKbMyjebP9 1-GkUosQI5mmJmSyNrK0GQdOV2X60_bBB 1DqqTHs1abDqv2-k1mTBiouhBojFDRHE- 1B_wZY7sjhYId-7kms44YLvGSfHUNX1Gq 1pRv6XgN-x_n020j_EHy1Z2Kh2cpbbJaz 1DKXqdMYdtS4hmz8znnchne3X44f85OXU 1etITArGc5V-EXZag9vNp6OfYiTfXAPE9 1t9OcdkRxjAPrSPxrSJrxrSEUY6REo44_ 1U2MIDGelgwmq2RaCQnUiL2ABvAmFvQjN 1DCgF6_6bJc2RfhJql4spv8L1Z5E8tp35 1p8MBxFmSL5Gp1rzXW96xvEHKRlNOtErO 1DYvAIEfCyiFJaezIDSyGfK1MY2EuBkt_ 1hqnzaGeZ_Uub_FjTbR6vaNX8-h9CXYJO 1r5_PybLRMcmogYVDpsNMhTbpyAnm4qBO 19QtiYgtZEd1Mshxk9hqPNGANreZ0EyyX 1BNjqBbXZ7yA-ovVSvqVHxWT_2QGiHNiY 1fdISn5SkllPW0Bsb1HrfpzPDeyA9akE- 11-X-o3yAhxHlqryuD4SDpQv7mea8hpvI 1dpwZXkb9i8DzIPb51QZJinrA4xh6YFNJ 1BcymCwy3jZJtHxp7zmejzudT4GhfTK5q 1lEAjN7-G7U7uyXknPTa4GUO1RQK6vClW 1-0stMgVn-Yutxx2i1oSgY8l91PJx3nqP 1V3ZHHwxOQTZY5CWqLYOoE1EZBp38UNlT 1fGITNFnGFCipqUUe6IsTJhkFjctVHweF 1tn38kN0gbWJsE3rVGjZG3xVPJ5NWfg2E 1x4rrqOxg0vO2WeFEZwFKl3kw0c99Z3kU 1pkehtJORT8Uy8sOukN1r6Lo5u0K0VI-s 1Ezl3y_nkO_6YGJbxIWYpig2A4GKQApEB 1MmoZN9Ji6eoHbeqwg8d-HO7aKh19rX09 1icZiirh1S1ix9EBAeW1mhALiqKMEJX3M 1yOt9qR_xdQGE8RP-jBRkjm4BpRm66eJ- 1GTZBJ7EksvJclvi2VlnWrdCio4wGnurd 1Qmj0lWUj7EcbkIVvbhXhh5VIVmpafF_3 1C32DmXSCXYk8C8Y3vVAJ82EP9Ra_qwU4 1x3KoL7KEtvg6X_UtCVtz39cD1vQHLy0M 1kHdBZODRGtfc-Ff2hwvhW5My5o0qZcoS 1JXQRHp8HRuMRJQipX5Ag92Ybltfy-1FL" data-drive-file-or-folder-id="1cj5J9YVU7EoNUJeB-u_kFMsjvlASAL8-" data-drive-folder-name="src" data-blot-name="document-embed" contenteditable="false"><div class="inner-container"><span class="document-embed-loading google-symbols" style="display: none;">progress_activity</span><span class="document-embed-icon material-symbols-outlined" aria-hidden="true" style="display: block;">folder</span><span class="document-embed-label gmat-body-medium truncate" title="" alt="" aria-label="">src<span class="document-embed-files-count gmat-body-medium">42 files</span></span><span class="document-embed-token-count gmat-body-medium">42,668 Tokens</span></div></div></td><!----><!----></tr><tr _ngcontent-ng-c1264270593="" class="ng-star-inserted"><td _ngcontent-ng-c1264270593="" class="source-label">Model:</td><td _ngcontent-ng-c1264270593="" class="prompt-text ng-star-inserted">This codebase contains various modules and classes related to the FastSD CPU application, which appears to be a tool for generating images using Stable Diffusion models on CPUs. Here's a breakdown of the different components:

**Paths:**
* `FastStableDiffusionPaths`: Provides methods for accessing different directories used by the application, such as the configuration directory, results directory, and models directory.

**State Management:**
* `_AppState`: A singleton class for managing application state, including settings and context.
* `get_state`, `get_settings`, `get_context`: Helper functions for accessing the application state and settings.

**Utilities:**
* `show_system_info`: Displays information about the system on which the application is running.
* `get_models_from_text_file`: Reads a list of models from a text file.
* `get_image_file_extension`: Returns the file extension for a given image format.
* `resize_pil_image`: Resizes a PIL image to the specified dimensions.

**Context:**
* `Context`: Represents the application context, including the interface type (CLI, GUI, or WebUI) and an instance of `LCMTextToImage` for generating images.

**Constants:**
* Defines various constants used throughout the application, such as application version, model IDs, and directory names.

**App Settings:**
* `AppSettings`: Loads and saves application settings from a YAML file.

**Command Line Interface:**
* Argument parser for handling command-line arguments.
* Logic for running the application in different modes (GUI, WebUI, CLI, etc.).

**LoRA:**
* Functions for loading, updating, and managing LoRA weights for customizing image generation.

**Backend:**
* `LCMTextToImage`: Class for generating images using Latent Consistency Models.
* `ImageSaver`: Saves generated images to disk.
* Modules for different image generation tasks (text-to-image, image-to-image, etc.).
* Modules for upscaling images using different methods.

**Frontend:**
* `cli_interactive`: Provides an interactive command-line interface for image generation.
* `gui`: Contains classes for building the desktop GUI using PyQt5.
* `webui`: Contains functions for building the web UI using Gradio.

**Models:**
* Defines data models for settings, image formats, and other application data.

**Overall, the codebase demonstrates a well-structured and modular design, separating different functionalities into distinct modules and classes.** 
</td><!----><!----></tr><!----><tr _ngcontent-ng-c1264270593="" class="ng-star-inserted"><td _ngcontent-ng-c1264270593="" class="source-label">User:</td><td _ngcontent-ng-c1264270593="" class="prompt-text ng-star-inserted">日本語で説明してください。</td><!----><!----></tr><tr _ngcontent-ng-c1264270593="" class="ng-star-inserted"><td _ngcontent-ng-c1264270593="" class="source-label">Model:</td><td _ngcontent-ng-c1264270593="" class="prompt-text ng-star-inserted">このコードベースには、CPU 上で Stable Diffusion モデルを使用して画像を生成するツールと思われる FastSD CPU アプリケーションに関連するさまざまなモジュールとクラスが含まれています。以下は、さまざまなコンポーネントの内訳です。

**パス:**
* `FastStableDiffusionPaths`: アプリケーションで使用されるさまざまなディレクトリ（構成ディレクトリ、結果ディレクトリ、モデルディレクトリなど）へのアクセス方法を提供します。

**状態管理:**
* `_AppState`: 設定やコンテキストなど、アプリケーションの状態を管理するシングルトンクラスです。
* `get_state`、`get_settings`、`get_context`: アプリケーションの状態や設定にアクセスするためのヘルパー関数です。

**ユーティリティ:**
* `show_system_info`: アプリケーションが実行されているシステムに関する情報を表示します。
* `get_models_from_text_file`: テキストファイルからモデルのリストを読み取ります。
* `get_image_file_extension`: 指定された画像形式のファイル拡張子を返します。
* `resize_pil_image`: PIL 画像を指定された寸法にサイズ変更します。

**コンテキスト:**
* `Context`: インターフェイスタイプ（CLI、GUI、または WebUI）と画像生成用の `LCMTextToImage` のインスタンスを含む、アプリケーションコンテキストを表します。

**定数:**
* アプリケーションのバージョン、モデル ID、ディレクトリ名など、アプリケーション全体で使用されるさまざまな定数を定義します。

**アプリ設定:**
* `AppSettings`: YAML ファイルからアプリケーション設定を読み込み、保存します。

**コマンドラインインターフェース:**
* コマンドライン引数を処理するための引数パーサー。
* アプリケーションをさまざまなモード（GUI、WebUI、CLI など）で実行するためのロジック。

**LoRA:**
* 画像生成をカスタマイズするための LoRA 重みの読み込み、更新、管理を行う関数。

**バックエンド:**
* `LCMTextToImage`: Latent Consistency Models を使用して画像を生成するクラス。
* `ImageSaver`: 生成された画像をディスクに保存します。
* さまざまな画像生成タスク（テキストから画像、画像から画像など）用のモジュール。
* さまざまな方法を使用して画像をアップスケールするためのモジュール。

**フロントエンド:**
* `cli_interactive`: 画像生成のための対話型コマンドラインインターフェースを提供します。
* `gui`: PyQt5 を使用してデスクトップ GUI を構築するためのクラスが含まれています。
* `webui`: Gradio を使用して Web UI を構築するための関数が含まれています。

**モデル:**
* 設定、画像形式、その他のアプリケーションデータのデータモデルを定義します。

**全体として、このコードベースは、さまざまな機能を個別のモジュールやクラスに分離した、よく構造化されたモジュール設計を示しています。**

</td><!----><!----></tr><!----><tr _ngcontent-ng-c1264270593="" class="ng-star-inserted"><td _ngcontent-ng-c1264270593="" class="source-label">User:</td><td _ngcontent-ng-c1264270593="" class="prompt-text ng-star-inserted">OpenVINO使用時にシード値を設定するコードの個所を示してください。</td><!----><!----></tr><tr _ngcontent-ng-c1264270593="" class="ng-star-inserted"><td _ngcontent-ng-c1264270593="" class="source-label">Model:</td><td _ngcontent-ng-c1264270593="" class="prompt-text ng-star-inserted">OpenVINO を使用して画像を生成する際、シード値を設定するコードは `backend/lcm_text_to_image.py` ファイルの `LCMTextToImage` クラスの `generate` メソッドにあります。

```python
def generate(
    self,
    lcm_diffusion_setting: LCMDiffusionSetting,
    reshape: bool = False,
) -&gt; Any:
    # ... (その他のコード)

    if lcm_diffusion_setting.use_seed:
        cur_seed = lcm_diffusion_setting.seed
        if self.use_openvino:
            np.random.seed(cur_seed)  # OpenVINO 使用時にシード値を設定する
        else:
            torch.manual_seed(cur_seed)

    # ... (その他のコード)
```

このコードは、`lcm_diffusion_setting.use_seed` が True の場合にシード値を設定します。OpenVINO を使用している場合は、`np.random.seed(cur_seed)` を使用してシード値を設定します。それ以外の場合は、PyTorch の `torch.manual_seed(cur_seed)` を使用します。
</td><!----><!----></tr><!----><!----></table><!----></div><!----></div><!----><!----></div></multiturn-preview></div><!----><div _ngcontent-ng-c3366247660="" class="preview-item"><div _ngcontent-ng-c3366247660="" class="item-about"><span _ngcontent-ng-c3366247660="" aria-hidden="true" class="material-symbols-outlined start-icon">generating_tokens</span> Token count </div><div _ngcontent-ng-c3366247660=""> 44,096 / 1,048,576 </div></div></div><!----></div></xap-inline-dialog-container>